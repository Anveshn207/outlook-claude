# KurweBall — Context Summary

## Session Summary
- **Date**: 2026-02-19
- **Project**: KurweBall — Unified Recruiting Platform (ATS + CRM)
- **Location**: `C:\Outlook Claude\Kurweball`
- **Branch**: master

### Accomplished This Session
1. **Fixed Import Upload Error (`[object Object]`)** — Root cause: multer MIME filter was too strict, rejecting valid files. Added `application/octet-stream`, `application/csv` to allowed types + file extension validation (`.csv`, `.xlsx`, `.xls`). Fixed frontend error message parsing to handle API's nested `{ error: { message } }` structure.
2. **Fixed XLSX Parser for Extensionless Files** — Multer saves files without extensions. Changed `XLSX.readFile(path)` to `XLSX.read(buffer)` so xlsx library auto-detects format from content. Updated both `file-parser.service.ts` and `import.service.ts`.
3. **Passed Original Filename Through Parser** — `parseFile()` now accepts `originalName` parameter to determine CSV vs XLSX format. Import service passes `file.originalname`.
4. **E2E Testing Complete** — All tests pass: Login, Dashboard, Candidates Import (full flow: upload→mapping→execute, 2 created 0 errors), Candidates List, Bench Sales, Jobs, Clients, Settings.

### Key Files Modified
- `apps/api/src/modules/import-export/import-export.module.ts` — Extended multer fileFilter with more MIME types + extension check
- `apps/api/src/modules/import-export/file-parser.service.ts` — Changed to buffer-based parsing, accepts originalName param
- `apps/api/src/modules/import-export/import.service.ts` — Passes file.originalname to parser, fixed getAllRows to use buffer
- `apps/web/src/components/shared/import-dialog.tsx` — Fixed error message extraction for nested API error responses

### What Needs To Be Done Next
1. **Admin full access + CSV/Excel export for all dashboard sections** — User requested "admin should have access to add or delete or edit or download as csv or excel for all the sections under the dashboard". NOT YET STARTED.
2. **Clean up test data** — Delete test "John Doe" and "Jane Smith" candidates created during E2E test, and "Rajesh Kumar" bench sales record
3. **Deploy to Hetzner** (65.108.218.222) — SSH port firewalled, need to whitelist IP first
4. **NotificationStream SSE cleanup** — Minor: add AbortController for clean SSE close on page transitions

### Database Users
| Name | Email | Password | Role |
|------|-------|----------|------|
| Anvesh N | anvesh.n@engineeringsquare.us | Admin123$ | ADMIN |
| Mounica A (Hr) | Hr@engineeringsquare.us | Test1234$ | MANAGER |
| Saikumar | saikumar@engineeringsquare.us | Test1234$ | MANAGER |
| Sarah Johnson | sarah@acme.com | password123 | RECRUITER |
| Mike Davis | mike@acme.com | password123 | RECRUITER |

## Resume Instructions
1. Read this file + `memory/MEMORY.md`
2. Start API: `cd apps/api && node --require @swc-node/register src/main.ts`
3. Start frontend: `cd apps/web && npm run dev`
4. Next priority: Implement admin full CRUD + CSV/Excel export for all dashboard sections
5. Import functionality is now working — verified end-to-end
